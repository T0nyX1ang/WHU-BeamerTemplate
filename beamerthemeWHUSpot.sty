% beamerthemeWHUSpot.sty v1.2.1
% A beamer theme based on the spots in Wuhan University.
% Author: Tony Xiang
% Licensed under the LaTeX Project Public License, v1.3c or later.

\mode<presentation>

\ProvidesPackage{beamerthemeWHUSpot}
\RequirePackage{tikz}
\usetikzlibrary{calc}
\RequirePackage{cncolours}
\RequirePackage{pgfmath}

\usefonttheme[onlymath]{serif}

\setbeamercolor{normal text}{fg=black}
\setbeamercolor{alerted text}{fg=酡红}
\setbeamercolor{example text}{fg=宝蓝}
\setbeamercolor{titlelike}{fg=black}
\setbeamercolor{frametitle}{fg=white,bg=海棠红}
\setbeamercolor{qed symbol}{fg=松花色}
\setbeamercolor{button}{fg=white,bg=松花色}
\setbeamercolor{footnote mark}{fg=松花色}
\setbeamercolor{block title}{fg=black}
\setbeamercolor{block title alerted}{fg=酡红}
\setbeamercolor{block title example}{fg=宝蓝}
\setbeamercolor{itemize item}{fg=宝蓝}
\setbeamercolor{itemize subitem}{fg=宝蓝}
\setbeamercolor{itemize subsubitem}{fg=宝蓝}
\setbeamercolor{enumerate item}{fg=宝蓝}
\setbeamercolor{enumerate subitem}{fg=宝蓝}
\setbeamercolor{enumerate subsubitem}{fg=宝蓝}
\setbeamercolor{background canvas}{bg=缟}

\input{./models/building.tex}
\input{./models/petal.tex}
\input{./models/cage.tex}

\def\progressbar{
    % draw a vertical progress bar here
    \begin{tikzpicture}
        % construct several paths to make room for the sakura
        \path (-0.5cm, 0) -- (0.5cm, 0);
        \draw[line width=0.3pt, color=粉红] (0, 0) -- (0, -0.8\paperheight);
        \pgfmathparse{-0.8 / \inserttotalframenumber * \paperheight * (\insertframenumber - 0.5)} % calculate the required shift
        \begin{scope}[yshift=\pgfmathresult, scale=.05]
            \drawsakura{1}
        \end{scope}
        \node[rounded corners, fill=gray, draw=gray, text width=4.5em, align=center, inner sep=2pt, text=white, anchor=east] at (0.405, -0.8\paperheight-5) %rounded rectangle west arc=none
        {
            \insertframenumber\ /\ \inserttotalframenumber
        };
    \end{tikzpicture}
}

\AtBeginSection[] % Do nothing for \section*
{
    \sectionpage
}

\AtBeginSection[*] % Do nothing for \section*
{
    \sectionpage
}

\setbeamertemplate{frametitle}[shadow theme]
\setbeamersize{sidebar width left=1cm}
\setbeamertemplate{sidebar left}
{
    \includegraphics[width=1cm,height=1cm]{./logos/whulogoblack.eps} \\
    \progressbar
}

\setbeamertemplate{title page}{
    % modified from default title page theme, adding a background canvas here.
    \ifbeamercolorempty[bg]{background canvas}{}{
        \centering
        \begin{tikzpicture}[scale=.4,opacity=.85]
            \useasboundingbox (-0.375, 15.2) rectangle (0.05, 10);
            \drawbuilding{雪白}{缟}
        \end{tikzpicture}
    }%
    \vbox{}
    \vfill
    \begingroup
        \begin{beamercolorbox}[sep=8pt,center]{title}
            \usebeamerfont{title}\inserttitle\par%
            \ifx\insertsubtitle\@empty%
            \else%
                \vskip0.25em%
                {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
            \fi%     
        \end{beamercolorbox}%
        \vskip1em\par
        \begin{beamercolorbox}[sep=8pt,center]{author}
            \usebeamerfont{author}\insertauthor
        \end{beamercolorbox}
        \begin{beamercolorbox}[sep=8pt,center]{institute}
            \usebeamerfont{institute}\insertinstitute
        \end{beamercolorbox}
        \begin{beamercolorbox}[sep=8pt,center]{date}
            \usebeamerfont{date}\insertdate
        \end{beamercolorbox}
        % no title graphics here
        \vskip2.3em
    \endgroup
    \vfill
}

\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{section page}
{
    \begingroup 
        \setbeamertemplate{background canvas}
        {
            \begin{tikzpicture}
                \fill[color=海棠红] (0, 0) rectangle (\paperwidth, \paperheight);
            \end{tikzpicture}
        }
        \begin{frame}[c, plain]
            \vskip 1.2em
            \textcolor{white}{\insertsection}
            \vskip 0.3em
            \hskip 0.1em
            % draw a horizontal progress bar here
            \begin{tikzpicture}
                \draw[line width=0.4pt, color=霜色] (0, 0) -- (.8\paperheight, 0);
                \pgfmathparse{0.8 / \inserttotalframenumber * \paperheight * (\insertframenumber - 0.5)} % calculate the required shift
                \begin{scope}[xshift=\pgfmathresult, scale=.05]
                    \drawsakura{2}
                \end{scope}
            \end{tikzpicture}
        \end{frame}
    \endgroup
}

% customize items
\setbeamertemplate{itemize item}
{
    \begin{tikzpicture}[scale=.06, yshift=1.2]
        \drawpetal{90}{嫣红}{樱桃色}{樱草色}{53}{-25}{0.25}{3.75}
    \end{tikzpicture}
}

\setbeamertemplate{itemize subitem}
{
    \begin{tikzpicture}[scale=.05, yshift=1]
        \drawpetal{90}{嫣红}{樱桃色}{樱草色}{53}{-25}{0.25}{3.75}
    \end{tikzpicture}
}

\setbeamertemplate{itemize subsubitem}
{
    \begin{tikzpicture}[scale=.04, yshift=.8]
        \drawpetal{90}{嫣红}{樱桃色}{樱草色}{53}{-25}{0.25}{3.75}
    \end{tikzpicture}
}

% customize blocks
\addtobeamertemplate{block begin}
{
    \begin{tikzpicture}[overlay]
        \drawcage{black}{.3\paperheight}{.1\paperheight}{0.05}{-0.3}
    \end{tikzpicture}
}{}

\addtobeamertemplate{block alerted begin}
{
    \begin{tikzpicture}[overlay]
        \drawcage{酡红}{.3\paperheight}{.1\paperheight}{0.05}{-0.3}
    \end{tikzpicture}
}{}

\addtobeamertemplate{block example begin}
{
    \begin{tikzpicture}[overlay]
        \drawcage{宝蓝}{.3\paperheight}{.1\paperheight}{0.05}{-0.3}
    \end{tikzpicture}
}{}

% theorems
\setbeamertemplate{theorems}[numbered]

\mode
<all>